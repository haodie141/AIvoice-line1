# æœ¬åœ°éƒ¨ç½²æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•åœ¨æœ¬åœ°ç¯å¢ƒéƒ¨ç½²å’Œè¿è¡Œ AI é™ªä¼´å­©å­æ™ºèƒ½ä½“é¡¹ç›®ã€‚

## ç›®å½•

- [ç¯å¢ƒè¦æ±‚](#ç¯å¢ƒè¦æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [è¯¦ç»†éƒ¨ç½²æ­¥éª¤](#è¯¦ç»†éƒ¨ç½²æ­¥éª¤)
- [è¿è¡Œæ¨¡å¼](#è¿è¡Œæ¨¡å¼)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## ç¯å¢ƒè¦æ±‚

### ç¡¬ä»¶è¦æ±‚

- **CPU**ï¼š2 æ ¸å¿ƒåŠä»¥ä¸Š
- **å†…å­˜**ï¼š4GB åŠä»¥ä¸Šï¼ˆæ¨è 8GBï¼‰
- **ç£ç›˜**ï¼š10GB åŠä»¥ä¸Šå¯ç”¨ç©ºé—´

### è½¯ä»¶è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**ï¼š
  - macOS 10.15+ (Catalina)
  - Ubuntu 20.04 LTS æˆ–æ›´é«˜ç‰ˆæœ¬
  - Windows 10/11ï¼ˆæ¨èä½¿ç”¨ WSL2ï¼‰

- **Python**ï¼š3.12 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Git**ï¼šç”¨äºå…‹éš†ä»£ç ä»“åº“
- **pip**ï¼šPython åŒ…ç®¡ç†å™¨

---

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
# ä½¿ç”¨ HTTPS å…‹éš†
git clone https://github.com/haodie141/AIvoice-line1.git

# æˆ–ä½¿ç”¨ SSH å…‹éš†ï¼ˆå¦‚æœé…ç½®äº† SSH å¯†é’¥ï¼‰
git clone git@github.com:haodie141/AIvoice-line1.git

# è¿›å…¥é¡¹ç›®ç›®å½•
cd AIvoice-line1
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰

**macOS / Linux:**
```bash
# ä½¿ç”¨ venv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate
```

**Windows (PowerShell):**
```powershell
# ä½¿ç”¨ venv åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\venv\Scripts\activate
```

**Windows (CMD):**
```cmd
python -m venv venv
venv\Scripts\activate.bat
```

### 3. å®‰è£…ä¾èµ–

```bash
# å‡çº§ pip
pip install --upgrade pip

# å®‰è£…é¡¹ç›®ä¾èµ–
pip install -r requirements.txt
```

**æ³¨æ„äº‹é¡¹ï¼š**
- å®‰è£…è¿‡ç¨‹å¯èƒ½éœ€è¦ 5-10 åˆ†é’Ÿï¼Œè¯·è€å¿ƒç­‰å¾…
- å¦‚æœé‡åˆ°æŸäº›åŒ…å®‰è£…å¤±è´¥ï¼Œå¯ä»¥å°è¯•ï¼š
  ```bash
  pip install --upgrade setuptools wheel
  pip install -r requirements.txt
  ```

### 4. è¿è¡Œé¡¹ç›®

```bash
# å¯åŠ¨ HTTP æœåŠ¡
python src/main.py -m http
```

æœåŠ¡å°†åœ¨ `http://localhost:5000` å¯åŠ¨ã€‚

### 5. æµ‹è¯•éƒ¨ç½²

**æ–¹æ³• 1ï¼šä½¿ç”¨ curl**
```bash
curl -X POST http://localhost:5000/run \
  -H "Content-Type: application/json" \
  -d '{
    "child_id": "test_001",
    "child_name": "æµ‹è¯•",
    "child_age": 10,
    "child_interests": ["ç”»ç”»", "ç§¯æœ¨"],
    "trigger_type": "conversation",
    "user_input_text": "ä½ å¥½"
  }'
```

**æ–¹æ³• 2ï¼šä½¿ç”¨ Python**
```python
import requests
import json

url = "http://localhost:5000/run"
payload = {
    "child_id": "test_001",
    "child_name": "æµ‹è¯•",
    "child_age": 10,
    "child_interests": ["ç”»ç”»", "ç§¯æœ¨"],
    "trigger_type": "conversation",
    "user_input_text": "ä½ å¥½"
}

response = requests.post(url, json=payload)
print(json.dumps(response.json(), ensure_ascii=False, indent=2))
```

**æ–¹æ³• 3ï¼šä½¿ç”¨æµè§ˆå™¨**
è®¿é—® `http://localhost:5000/health`ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```json
{
  "status": "ok",
  "message": "Service is running"
}
```

---

## è¯¦ç»†éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤ 1ï¼šç¯å¢ƒå‡†å¤‡

#### 1.1 æ£€æŸ¥ Python ç‰ˆæœ¬

```bash
python --version
# æˆ–
python3 --version
```

ç¡®ä¿è¾“å‡ºä¸º `Python 3.12.x` æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚å¦‚æœä¸æ˜¯ï¼Œè¯·å…ˆå®‰è£… Python 3.12ã€‚

#### 1.2 æ£€æŸ¥ Git ç‰ˆæœ¬

```bash
git --version
```

å¦‚æœæœªå®‰è£… Gitï¼Œè¯·è®¿é—® [Git å®˜ç½‘](https://git-scm.com/downloads) ä¸‹è½½å®‰è£…ã€‚

### æ­¥éª¤ 2ï¼šå…‹éš†ä»£ç 

```bash
# è¿›å…¥ä½ æƒ³è¦å­˜æ”¾é¡¹ç›®çš„ç›®å½•
cd ~/projects  # æˆ–ä»»æ„ç›®å½•

# å…‹éš†é¡¹ç›®
git clone https://github.com/haodie141/AIvoice-line1.git

# è¿›å…¥é¡¹ç›®ç›®å½•
cd AIvoice-line1
```

### æ­¥éª¤ 3ï¼šåˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

**ä¸ºä»€ä¹ˆä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Ÿ**
- éš”ç¦»é¡¹ç›®ä¾èµ–ï¼Œé¿å…ä¸ç³»ç»Ÿ Python ç¯å¢ƒå†²çª
- ä¾¿äºä¾èµ–ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶
- å¯ä»¥è½»æ¾åˆ é™¤å’Œé‡å»º

**macOS / Linux:**
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# éªŒè¯è™šæ‹Ÿç¯å¢ƒ
which python  # åº”è¯¥æ˜¾ç¤ºé¡¹ç›®ç›®å½•ä¸‹çš„ python è·¯å¾„
```

**Windows (PowerShell):**
```powershell
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\venv\Scripts\activate

# éªŒè¯è™šæ‹Ÿç¯å¢ƒ
where python  # åº”è¯¥æ˜¾ç¤ºé¡¹ç›®ç›®å½•ä¸‹çš„ python è·¯å¾„
```

### æ­¥éª¤ 4ï¼šå®‰è£…ä¾èµ–

```bash
# å‡çº§ pipï¼ˆæ¨èï¼‰
pip install --upgrade pip

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# éªŒè¯å®‰è£…
pip list
```

**å¸¸è§é—®é¢˜ï¼š**

**é—®é¢˜ 1ï¼š`pip install` é€Ÿåº¦æ…¢**
```bash
# ä½¿ç”¨å›½å†…é•œåƒæº
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
```

**é—®é¢˜ 2ï¼šæŸäº›åŒ…å®‰è£…å¤±è´¥**
```bash
# å°è¯•å‡çº§æ„å»ºå·¥å…·
pip install --upgrade setuptools wheel

# ç„¶åé‡æ–°å®‰è£…
pip install -r requirements.txt
```

**é—®é¢˜ 3ï¼š`lxml` æˆ–å…¶ä»– C æ‰©å±•åŒ…å®‰è£…å¤±è´¥ï¼ˆUbuntuï¼‰**
```bash
# å®‰è£…ç³»ç»Ÿä¾èµ–
sudo apt-get update
sudo apt-get install -y python3-dev libxml2-dev libxslt-dev

# ç„¶åé‡æ–°å®‰è£…
pip install -r requirements.txt
```

### æ­¥éª¤ 5ï¼šé…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰

åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º .env æ–‡ä»¶
cat > .env << EOF
# å·¥ä½œæµæ¨¡å¼ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º full_companionï¼‰
COZE_GRAPH_MODE=full_companion

# å·¥ä½œç›®å½•ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸ºé¡¹ç›®æ ¹ç›®å½•ï¼‰
COZE_WORKSPACE_PATH=/path/to/AIvoice-line1

# æ—¥å¿—çº§åˆ«ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä¸º INFOï¼‰
LOG_LEVEL=INFO
EOF
```

**ç¯å¢ƒå˜é‡è¯´æ˜ï¼š**

| å˜é‡å | è¯´æ˜ | å¯é€‰å€¼ | é»˜è®¤å€¼ |
|--------|------|--------|--------|
| `COZE_GRAPH_MODE` | å·¥ä½œæµæ¨¡å¼ | `full_companion` / `detailed` / `realtime_call` | `full_companion` |
| `COZE_WORKSPACE_PATH` | å·¥ä½œç›®å½•è·¯å¾„ | ä»»æ„ç»å¯¹è·¯å¾„ | é¡¹ç›®æ ¹ç›®å½• |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `DEBUG` / `INFO` / `WARNING` / `ERROR` | `INFO` |

### æ­¥éª¤ 6ï¼šéªŒè¯å®‰è£…

```bash
# æµ‹è¯•å¯¼å…¥æ ¸å¿ƒæ¨¡å—
python -c "import langgraph; print(f'LangGraph ç‰ˆæœ¬: {langgraph.__version__}')"
python -c "import langchain; print(f'LangChain ç‰ˆæœ¬: {langchain.__version__}')"

# æµ‹è¯•å¯¼å…¥é¡¹ç›®æ¨¡å—
python -c "from graphs.graph import main_graph; print('å·¥ä½œæµåŠ è½½æˆåŠŸ')"
```

### æ­¥éª¤ 7ï¼šå¯åŠ¨æœåŠ¡

#### 7.1 å¯åŠ¨ HTTP æœåŠ¡

```bash
# ä½¿ç”¨é»˜è®¤ç«¯å£ 5000
python src/main.py -m http

# æˆ–æŒ‡å®šç«¯å£
python src/main.py -m http -p 8080
```

#### 7.2 è¿è¡Œå®Œæ•´å·¥ä½œæµï¼ˆflow æ¨¡å¼ï¼‰

```bash
# ä½¿ç”¨é»˜è®¤è¾“å…¥
python src/main.py -m flow

# ä½¿ç”¨è‡ªå®šä¹‰è¾“å…¥
python src/main.py -m flow -i '{
  "child_id": "test_001",
  "child_name": "å°æ˜",
  "child_age": 10,
  "trigger_type": "conversation",
  "user_input_text": "ä½ å¥½"
}'
```

#### 7.3 è¿è¡Œå•ä¸ªèŠ‚ç‚¹ï¼ˆnode æ¨¡å¼ï¼‰

```bash
# è¿è¡Œå¿«é€Ÿå›å¤èŠ‚ç‚¹
python src/main.py -m node -n quick_reply_node -i '{
  "child_id": "test_001",
  "child_name": "å°æ˜",
  "child_age": 10,
  "user_input_text": "æ—©"
}'
```

---

## è¿è¡Œæ¨¡å¼

### 1. HTTP æœåŠ¡æ¨¡å¼ï¼ˆæ¨èï¼‰

å¯åŠ¨æ–¹å¼ï¼š
```bash
python src/main.py -m http
```

ç‰¹ç‚¹ï¼š
- âœ… æä¾› REST API æ¥å£
- âœ… æ”¯æŒæµå¼è¾“å‡º
- âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ
- âœ… å¯ä»¥éƒ¨ç½²ä¸ºæœåŠ¡

API ç«¯ç‚¹ï¼š
- `POST /run` - è¿è¡Œå®Œæ•´å·¥ä½œæµ
- `POST /stream` - æµå¼è¿è¡Œå·¥ä½œæµ
- `GET /health` - å¥åº·æ£€æŸ¥
- `GET /graph_parameter` - è·å–å·¥ä½œæµå‡ºå‚å®šä¹‰

### 2. å®Œæ•´æ¨¡å¼ï¼ˆfull_companionï¼‰

è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export COZE_GRAPH_MODE=full_companion
python src/main.py -m http
```

ç‰¹ç‚¹ï¼š
- âœ… åŠŸèƒ½å®Œæ•´ï¼Œæ€§èƒ½ä¼˜å…ˆ
- âœ… åŒ…å«æ‰€æœ‰ä¼˜åŒ–ï¼ˆv2.0ï¼‰
- âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ

### 3. å¯è§†åŒ–æ¨¡å¼ï¼ˆdetailedï¼‰

è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export COZE_GRAPH_MODE=detailed
python src/main.py -m http
```

ç‰¹ç‚¹ï¼š
- âœ… æ­¥éª¤çº§èŠ‚ç‚¹æ‹†åˆ†
- âœ… ç±»ä¼¼æ‰£å­å·¥ä½œæµ
- âœ… é€‚åˆè°ƒè¯•å’Œç†è§£

### 4. å®æ—¶é€šè¯æ¨¡å¼ï¼ˆrealtime_callï¼‰

è®¾ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
export COZE_GRAPH_MODE=realtime_call
python src/main.py -m http
```

ç‰¹ç‚¹ï¼š
- âœ… ä½å»¶è¿Ÿï¼ˆ1-2 ç§’ï¼‰
- âœ… ç²¾ç®€æµç¨‹
- âœ… é€‚åˆå®æ—¶è¯­éŸ³å¯¹è¯

---

## é…ç½®è¯´æ˜

### å¤§è¯­è¨€æ¨¡å‹é…ç½®

é¡¹ç›®ä½¿ç”¨ `coze-coding-dev-sdk` æä¾›çš„å¤§è¯­è¨€æ¨¡å‹æœåŠ¡ï¼Œæ— éœ€é…ç½® API Keyã€‚

é…ç½®æ–‡ä»¶ä½äº `config/` ç›®å½•ï¼š
- `quick_reply_llm_cfg.json` - å¿«é€Ÿå›å¤èŠ‚ç‚¹é…ç½®
- `quick_chat_llm_cfg.json` - è½»é‡çº§èŠå¤©èŠ‚ç‚¹é…ç½®
- `realtime_conversation_llm_cfg.json` - å®æ—¶å¯¹è¯èŠ‚ç‚¹é…ç½®
- `active_care_llm_cfg.json` - ä¸»åŠ¨å…³å¿ƒèŠ‚ç‚¹é…ç½®

**ç¤ºä¾‹é…ç½®ï¼š**
```json
{
    "config": {
        "model": "doubao-seed-1-6-flash-250615",
        "temperature": 0.7,
        "max_tokens": 50,
        "top_p": 0.9
    },
    "sp": "ç³»ç»Ÿæç¤ºè¯å†…å®¹...",
    "up": "ç”¨æˆ·æç¤ºè¯å†…å®¹..."
}
```

### å†…å­˜å­˜å‚¨é…ç½®

é¡¹ç›®ä½¿ç”¨å†…å­˜å­˜å‚¨ï¼ˆMemoryStoreï¼‰ï¼Œæ— éœ€é…ç½®æ•°æ®åº“ã€‚

**æ•°æ®æŒä¹…åŒ–ï¼ˆå¯é€‰ï¼‰ï¼š**
å¦‚æœéœ€è¦æŒä¹…åŒ–å­˜å‚¨ï¼Œå¯ä»¥ä¿®æ”¹ `src/storage/memory_store.py`ï¼Œå°†æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶æˆ–æ•°æ®åº“ã€‚

### æ—¥å¿—é…ç½®

æ—¥å¿—é»˜è®¤è¾“å‡ºåˆ°ï¼š
- æ§åˆ¶å°ï¼ˆconsoleï¼‰
- æ–‡ä»¶ï¼š`/app/work/logs/bypass/app.log`

**ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼š**
```bash
# æ–¹æ³• 1ï¼šç¯å¢ƒå˜é‡
export LOG_LEVEL=DEBUG

# æ–¹æ³• 2ï¼šä¿®æ”¹ä»£ç 
# ç¼–è¾‘ src/main.py ä¸­çš„ LOG_LEVEL å¸¸é‡
```

---

## API ä½¿ç”¨ç¤ºä¾‹

### 1. è¿è¡Œå®Œæ•´å·¥ä½œæµ

**è¯·æ±‚ï¼š**
```bash
curl -X POST http://localhost:5000/run \
  -H "Content-Type: application/json" \
  -d '{
    "child_id": "child_001",
    "child_name": "å°æ˜",
    "child_age": 10,
    "child_interests": ["ç”»ç”»", "ç§¯æœ¨"],
    "trigger_type": "conversation",
    "user_input_text": "ä½ å¥½"
  }'
```

**å“åº”ï¼š**
```json
{
  "ai_response": "ä½ å¥½å‘€å°æ˜ï¼Œä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ",
  "ai_response_audio": "https://...",
  "trigger_type": "conversation",
  "speaking_practice_count": 0,
  "quick_response": "ä½ å¥½å‘€å°æ˜ï¼Œä»Šå¤©è¿‡å¾—æ€ä¹ˆæ ·ï¼Ÿ",
  "followup_question": "",
  "scenario_type": "quick_reply",
  "execution_path": ["quick_reply"],
  "performance_metrics": {
    "cache_hit": false
  },
  "crisis_detected": false
}
```

### 2. æµå¼è¿è¡Œ

**è¯·æ±‚ï¼š**
```bash
curl -N -X POST http://localhost:5000/stream \
  -H "Content-Type: application/json" \
  -d '{
    "child_id": "child_001",
    "child_name": "å°æ˜",
    "child_age": 10,
    "trigger_type": "conversation",
    "user_input_text": "ä½ å¥½"
  }'
```

### 3. è·å–å·¥ä½œæµå‡ºå‚å®šä¹‰

**è¯·æ±‚ï¼š**
```bash
curl http://localhost:5000/graph_parameter
```

**å“åº”ï¼š**
```json
{
  "input_schema": {...},
  "output_schema": {...}
}
```

---

## å¸¸è§é—®é¢˜

### Q1: `ModuleNotFoundError: No module named 'xxx'`

**åŸå› ï¼š** ä¾èµ–æœªæ­£ç¡®å®‰è£…

**è§£å†³æ–¹æ³•ï¼š**
```bash
# é‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æˆ–å®‰è£…ç‰¹å®šåŒ…
pip install <ç¼ºå¤±çš„åŒ…å>
```

### Q2: `ImportError: cannot import name 'xxx' from 'xxx'`

**åŸå› ï¼š** åŒ…ç‰ˆæœ¬ä¸å…¼å®¹

**è§£å†³æ–¹æ³•ï¼š**
```bash
# å‡çº§ç›¸å…³åŒ…
pip install --upgrade <åŒ…å>

# æˆ–æŒ‡å®šç‰ˆæœ¬
pip install <åŒ…å>==<ç‰ˆæœ¬å·>
```

### Q3: ç«¯å£è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯ï¼š** `Address already in use`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ–¹æ³• 1ï¼šä½¿ç”¨å…¶ä»–ç«¯å£
python src/main.py -m http -p 8080

# æ–¹æ³• 2ï¼šåœæ­¢å ç”¨ç«¯å£ 5000 çš„è¿›ç¨‹
# Linux/macOS
lsof -i :5000
kill -9 <PID>

# Windows
netstat -ano | findstr :5000
taskkill /PID <PID> /F
```

### Q4: æƒé™ä¸è¶³

**é”™è¯¯ä¿¡æ¯ï¼š** `Permission denied`

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ–¹æ³• 1ï¼šä½¿ç”¨ sudoï¼ˆä¸æ¨èï¼‰
sudo python src/main.py -m http

# æ–¹æ³• 2ï¼šä¿®æ”¹æ–‡ä»¶æƒé™
chmod +x src/main.py

# æ–¹æ³• 3ï¼šä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
source venv/bin/activate
python src/main.py -m http
```

### Q5: è™šæ‹Ÿç¯å¢ƒæ¿€æ´»å¤±è´¥

**Windows PowerShell é”™è¯¯ï¼š**
```
æ— æ³•åŠ è½½æ–‡ä»¶ï¼Œå› ä¸ºåœ¨æ­¤ç³»ç»Ÿä¸Šç¦æ­¢è¿è¡Œè„šæœ¬
```

**è§£å†³æ–¹æ³•ï¼š**
```powershell
# ä¸´æ—¶å…è®¸è„šæœ¬è¿è¡Œ
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process

# ç„¶åé‡æ–°æ¿€æ´»
.\venv\Scripts\activate
```

### Q6: ä¾èµ–å®‰è£…å¤±è´¥ï¼ˆç‰¹åˆ«æ˜¯ lxmlã€opencv ç­‰ï¼‰

**Ubuntu/Debian:**
```bash
# å®‰è£…ç³»ç»Ÿä¾èµ–
sudo apt-get update
sudo apt-get install -y python3-dev libxml2-dev libxslt-dev libjpeg-dev zlib1g-dev

# ç„¶åé‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

**macOS (ä½¿ç”¨ Homebrew):**
```bash
# å®‰è£…ç³»ç»Ÿä¾èµ–
brew install libxml2 libxslt

# è®¾ç½®ç¯å¢ƒå˜é‡
export LDFLAGS="-L$(brew --prefix libxml2)/lib"
export CPPFLAGS="-I$(brew --prefix libxml2)/include"

# ç„¶åé‡æ–°å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### Q7: é¡¹ç›®è¿è¡ŒåæŠ¥é”™æ‰¾ä¸åˆ°æ¨¡å—

**é”™è¯¯ä¿¡æ¯ï¼š** `ModuleNotFoundError: No module named 'graphs.graph'`

**åŸå› ï¼š** Python è·¯å¾„é…ç½®é—®é¢˜

**è§£å†³æ–¹æ³•ï¼š**
```bash
# æ–¹æ³• 1ï¼šä»é¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
cd /path/to/AIvoice-line1
python src/main.py -m http

# æ–¹æ³• 2ï¼šè®¾ç½® PYTHONPATH
export PYTHONPATH=/path/to/AIvoice-line1/src:$PYTHONPATH
python src/main.py -m http

# æ–¹æ³• 3ï¼šä½¿ç”¨ -m æ¨¡å—è¿è¡Œï¼ˆæ¨èï¼‰
python -m src.main -m http
```

### Q8: å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ï¼Ÿ

**æ–¹æ³• 1ï¼šæ§åˆ¶å°è¾“å‡º**
```bash
# æ—¥å¿—ä¼šç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å°
python src/main.py -m http
```

**æ–¹æ³• 2ï¼šæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶**
```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f /app/work/logs/bypass/app.log

# æŸ¥çœ‹æœ€è¿‘ 20 è¡Œ
tail -n 20 /app/work/logs/bypass/app.log

# æœç´¢é”™è¯¯
grep -i "error" /app/work/logs/bypass/app.log
```

### Q9: å¦‚ä½•åœæ­¢æœåŠ¡ï¼Ÿ

**æ–¹æ³• 1ï¼šCtrl + C**
```bash
# åœ¨è¿è¡ŒæœåŠ¡çš„ç»ˆç«¯æŒ‰ Ctrl + C
```

**æ–¹æ³• 2ï¼šæŸ¥æ‰¾å¹¶æ€æ‰è¿›ç¨‹**
```bash
# Linux/macOS
ps aux | grep "python src/main.py"
kill -9 <PID>

# Windows
tasklist | findstr python
taskkill /PID <PID> /F
```

### Q10: å¦‚ä½•æ›´æ–°é¡¹ç›®ï¼Ÿ

```bash
# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# é‡æ–°å®‰è£…ä¾èµ–ï¼ˆå¦‚æœ requirements.txt æœ‰å˜åŒ–ï¼‰
pip install -r requirements.txt

# é‡å¯æœåŠ¡
python src/main.py -m http
```

---

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®

### 1. ä½¿ç”¨ Gunicorn

```bash
# å®‰è£… Gunicorn
pip install gunicorn

# å¯åŠ¨æœåŠ¡ï¼ˆ4 ä¸ª workerï¼‰
gunicorn -w 4 -k uvicorn.workers.UvicornWorker -b 0.0.0.0:5000 src.main:app
```

### 2. ä½¿ç”¨ Supervisor

åˆ›å»ºé…ç½®æ–‡ä»¶ `/etc/supervisor/conf.d/ai-companion.conf`ï¼š
```ini
[program:ai-companion]
command=/path/to/AIvoice-line1/venv/bin/python -m src.main -m http
directory=/path/to/AIvoice-line1
user=www-data
autostart=true
autorestart=true
stderr_logfile=/var/log/ai-companion.err.log
stdout_logfile=/var/log/ai-companion.out.log
```

å¯åŠ¨ï¼š
```bash
supervisorctl reread
supervisorctl update
supervisorctl start ai-companion
```

### 3. ä½¿ç”¨ Docker

åˆ›å»º `Dockerfile`ï¼š
```dockerfile
FROM python:3.12-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["python", "-m", "src.main", "-m", "http", "-p", "5000"]
```

æ„å»ºå’Œè¿è¡Œï¼š
```bash
# æ„å»ºé•œåƒ
docker build -t ai-companion .

# è¿è¡Œå®¹å™¨
docker run -p 5000:5000 ai-companion
```

### 4. ä½¿ç”¨ Nginx åå‘ä»£ç†

åˆ›å»º Nginx é…ç½® `/etc/nginx/sites-available/ai-companion`ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

å¯ç”¨é…ç½®ï¼š
```bash
sudo ln -s /etc/nginx/sites-available/ai-companion /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

---

## æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. ä½¿ç”¨ç¼“å­˜

```bash
# å¯ç”¨ Redis ç¼“å­˜ï¼ˆéœ€è¦å®‰è£… redis-pyï¼‰
pip install redis
```

### 2. ä½¿ç”¨ CDN

å°†ç”Ÿæˆçš„éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ åˆ° CDNï¼Œæé«˜è®¿é—®é€Ÿåº¦ã€‚

### 3. æ•°æ®åº“è¿æ¥æ± 

å¦‚æœä½¿ç”¨æ•°æ®åº“ï¼Œé…ç½®è¿æ¥æ± å‡å°‘è¿æ¥å¼€é”€ã€‚

### 4. å¼‚æ­¥å¤„ç†

å¯¹äºè€—æ—¶çš„æ“ä½œï¼ˆå¦‚éŸ³é¢‘åˆæˆï¼‰ï¼Œä½¿ç”¨å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼ˆå¦‚ Celeryï¼‰ã€‚

---

## å®‰å…¨å»ºè®®

### 1. é™åˆ¶è®¿é—®

```bash
# ä½¿ç”¨é˜²ç«å¢™é™åˆ¶è®¿é—®
sudo ufw allow from 192.168.1.0/24 to any port 5000
```

### 2. ä½¿ç”¨ HTTPS

é…ç½® SSL è¯ä¹¦ï¼Œä½¿ç”¨ HTTPS åè®®ã€‚

### 3. è®¤è¯å’Œæˆæƒ

æ·»åŠ  API è®¤è¯æœºåˆ¶ï¼ˆå¦‚ JWTã€OAuth2ï¼‰ã€‚

### 4. è¾“å…¥éªŒè¯

å¯¹æ‰€æœ‰è¾“å…¥å‚æ•°è¿›è¡ŒéªŒè¯å’Œæ¸…ç†ï¼Œé˜²æ­¢æ³¨å…¥æ”»å‡»ã€‚

---

## è·å–å¸®åŠ©

å¦‚æœé‡åˆ°å…¶ä»–é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹ [é¡¹ç›® README](../README.md)
2. æŸ¥çœ‹ [v2.0 æ›´æ–°è¯´æ˜](./v2.0æ›´æ–°è¯´æ˜.md)
3. æŸ¥çœ‹ [èŠ‚ç‚¹è¯¦ç»†è¯´æ˜](./èŠ‚ç‚¹è¯¦ç»†è¯´æ˜.md)
4. åœ¨ [GitHub Issues](https://github.com/haodie141/AIvoice-line1/issues) æé—®

---

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

---

**ç¥ä½ éƒ¨ç½²é¡ºåˆ©ï¼** ğŸš€
