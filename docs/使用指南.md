# AI语音陪伴机器人使用指南

## 快速开始

### 方式一：实时通话模式（推荐，低延迟）

专为实时通话优化，最小化响应延迟。整合ASR+LLM+TTS，适合实时对话场景。

```json
{
  "trigger_type": "realtime_call",
  "user_input_audio": {
    "url": "https://your-audio-url.com/audio.mp3",
    "file_type": "audio"
  }
}
```

**延迟优化：**
- 跳过历史记忆加载，减少初始化时间
- 限制LLM输出至150 tokens，加快生成速度
- 降低TTS采样率至16kHz，缩短合成时间
- 异步保存记忆，不阻塞主流程
- 简化提示词，减少token处理

**使用场景：**
- 实时语音对话
- 快速问答
- 即时互动

### 方式二：纯音频输入

您只需要提供音频文件，无需填写任何其他参数：

```json
{
  "user_input_audio": {
    "url": "https://your-audio-url.com/audio.mp3",
    "file_type": "audio"
  }
}
```

**默认配置：**
- 孩子姓名：小朋友
- 孩子年龄：8岁
- 兴趣爱好：阅读、游戏
- 触发类型：实时对话

工作流会自动：
1. 进行语音识别（ASR）
2. 提取对话内容
3. 生成友好的AI回复
4. 合成语音（TTS）
5. 返回文本和音频回复

### 方式二：自定义参数

如果您想要个性化配置，可以指定以下参数：

```json
{
  "child_name": "小明",
  "child_age": 10,
  "child_interests": ["画画", "游泳", "科学"],
  "user_input_audio": {
    "url": "https://your-audio-url.com/audio.mp3",
    "file_type": "audio"
  }
}
```

### 方式三：文本输入

您也可以直接输入文本，无需音频：

```json
{
  "user_input_text": "你好，今天天气怎么样？"
}
```

## 功能说明

### 1. 实时对话
- 智能理解孩子的问题和需求
- 时间感知（早上/下午/晚上）
- 对话历史记忆
- 教育和引导

### 2. 作业管理
- 智能作业提醒
- 时间有效性判断（过期作业不提醒）
- 自动识别作业完成
- 支持通过自然对话报告作业完成

### 3. 主动关心
- 基于时间的问候
- 结合兴趣爱好的话题
- 关注情绪和需求

### 4. 口语练习
- 语音识别
- 纠正错误
- 鼓励和指导
- 练习次数统计

## 触发类型

| 类型 | 说明 | 延迟 | 使用场景 |
|-----|------|------|---------|
| realtime_call | 实时通话（推荐） | 低 | 实时语音对话、快速问答、即时互动 |
| conversation | 实时对话 | 中 | 日常聊天、问答（带历史记忆） |
| practice | 口语练习 | 中 | 语音训练 |
| care | 主动关心 | 中 | 定时问候、情感陪伴 |
| remind | 作业提醒 | 低 | 作业提醒 |

## 音频格式支持

- MP3
- WAV
- M4A
- OGG

建议采样率：24000Hz

## 示例

### 示例1：纯音频输入（最简单）

```bash
# 假设您有一个音频文件 audio.mp3
curl -X POST http://your-api-endpoint \
  -H "Content-Type: application/json" \
  -d '{
    "user_input_audio": {
      "url": "https://example.com/audio.mp3",
      "file_type": "audio"
    }
  }'
```

### 示例2：自定义配置

```bash
curl -X POST http://your-api-endpoint \
  -H "Content-Type: application/json" \
  -d '{
    "child_name": "小红",
    "child_age": 9,
    "child_interests": ["钢琴", "跳舞"],
    "user_input_audio": {
      "url": "https://example.com/audio.mp3",
      "file_type": "audio"
    }
  }'
```

### 示例3：触发作业提醒

```bash
curl -X POST http://your-api-endpoint \
  -H "Content-Type: application/json" \
  -d '{
    "trigger_type": "remind",
    "child_name": "小明",
    "child_age": 8
  }'
```

## 返回结果

```json
{
  "ai_response": "早上好呀小明！很高兴认识你...",
  "ai_response_audio": "https://example.com/response.mp3",
  "trigger_type": "conversation",
  "speaking_practice_count": 0,
  "run_id": "uuid"
}
```

## 注意事项

1. **音频质量**：建议使用清晰的音频，避免背景噪音
2. **文件大小**：建议音频文件不超过10MB
3. **响应时间**：语音识别和合成需要一定时间，请耐心等待
4. **长期记忆**：对话历史会自动保存，最多保留100条记录
5. **作业管理**：作业数据存储在内存中，重启后会重置

## 技术支持

如有问题，请联系开发团队。
